##########################################################################
###                             Samarth Mathur                          ###
###                        PhD Candidate, DeWoody Lab                   ###
###                           Purdue University                         ###
###                                                                     ###
###     Date Created: 08/23/20                  Last Modified: 09/09/20 ###
###########################################################################
###########################################################################
###                     variant_filtering.sh                        	###
###########################################################################

cd $SLURM_SUBMIT_DIR
module purge
module load bioinfo
#module load bwa
#module load picard-tools
#module load bedops
#module load GATK/4.1.6.0
#module load samtools
module load vcftools

# GATK 
gatk --java-options "-Xmx220g" SelectVariants \
--select-type-to-include SNP \
-R /scratch/snyder/m/mathur20/MQU/ch3/align/chick/ref/chicken_genome.fa \
-V /scratch/snyder/m/mathur20/MQU/ch3/variants/final_vcf/mqu.all102.raw.GATK.vcf \
-O /scratch/snyder/m/mathur20/MQU/ch3/variants/final_vcf/mqu.all102.raw.GATK.SNPs.vcf

gatk --java-options "-Xmx100g" VariantFiltration \
-R /scratch/snyder/m/mathur20/MQU/ch3/align/chick/ref/chicken_genome.fa \
-V /scratch/snyder/m/mathur20/MQU/ch3/variants/final_vcf/mqu.all102.raw.GATK.SNPs.vcf \
-O /scratch/snyder/m/mathur20/MQU/ch3/variants/final_vcf/mqu.all102.filtered.GATK.SNPs.vcf \
--filter-name "QD" \
--filter-expression "QD < 2.0" \
--filter-name "FS" \
--filter-expression "FS > 40.0" \
--filter-name "SOR" \
--filter-expression "SOR > 5.0" \
--filter-name "MQ" \
--filter-expression "MQ< 20.0" \
--filter-name "MQRankSum" \
--filter-expression " MQRankSum < -3.0 || MQRankSum > 3.0" \
--filter-name "ReadPosRankSum" \
--filter-expression "ReadPosRankSum < -8.0" \
--filter-name "AN" \
--filter-expression "AN < 130" 

gatk SelectVariants \
-R /scratch/snyder/m/mathur20/MQU/ch3/align/chick/ref/chicken_genome.fa \
-V mqu.all102.filtered.GATK.SNPs.vcf \
-select 'vc.isNotFiltered()' \
-O all_gatk_filter.vcf

#Remove sex, mito, and small scaff (<1Mb)

#vcftools --vcf all_gatk_filter.vcf \
#--recode --recode-INFO-all \
#--not-chr NC_006127.5 \
#--not-chr NC_040902.1 \
#--not-chr NC_006119.4 \
#--not-chr NC_006126.5 \
#--not-chr NW_020110162.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110162.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110153.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110153.1 \
#--not-chr NW_020110153.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110162.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110157.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110004.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109888.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110128.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109986.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020109981.1 \
#--not-chr NW_020109988.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110114.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110162.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110158.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110147.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110155.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110155.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110143.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110153.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110141.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109834.1 \
#--not-chr NW_020110125.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110162.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110068.1 \
#--not-chr NW_020110061.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110162.1 \
#--not-chr NW_020110162.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110159.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110144.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110146.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020109924.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020109979.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110100.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110114.1 \
#--not-chr NW_020110064.1 \
#--not-chr NW_020110052.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020109937.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110159.1 \
#--not-chr NW_020110153.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110159.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110162.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110076.1 \
#--not-chr NW_020110047.1 \
#--not-chr NW_020110144.1 \
#--not-chr NW_020110141.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110161.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020109840.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110043.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110155.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110018.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110155.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109758.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110070.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109859.1 \
#--not-chr NW_020110153.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020109859.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020109989.1 \
#--not-chr NW_020110019.1 \
#--not-chr NW_020110167.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110156.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110162.1 \
#--not-chr NW_020110052.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110018.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110164.1 \
#--not-chr NW_020110160.1 \
#--not-chr NW_020110022.1 \
#--not-chr NW_020110165.1 \
#--not-chr NW_020110163.1 \
#--not-chr NW_020109834.1 \
#--not-chr NW_020110125.1 \
#--not-chr NW_020110165.1 \
#--indv E6536 \
#--indv E6609 \
#--indv E6628 \
#--indv E6846 \
#--indv E6877 \
#--indv E7031 \
#--indv E7125 \
#--indv E7146 \
#--indv E7208 \
#--indv E7220 \
#--indv E7563 \
#--indv E7746 \
#--indv E7747 \
#--indv E7751 \
#--indv E7752 \
#--indv E7927 \
#--indv E7932 \
#--indv E7934 \
#--indv E7946 \
#--indv E7969 \
#--indv E8013 \
#--indv E8017 \
#--indv E8024 \
#--indv E8025 \
#--indv E8030 \
#--indv E8031 \
#--indv E8032 \
#--indv E8142 \
#--indv E8946 \
#--indv E8947 \
#--indv E8948 \
#--indv E8949 \
#--indv E8954 \
#--indv E9030 \
#--indv E9031 \
#--indv E9032 \
#--indv E9033 \
#--indv E9034 \
#--indv E9035 \
#--indv E9036 \
#--indv E9037 \
#--indv E9038 \
#--indv E9039 \
#--indv E9040 \
#--indv E9041 \
#--indv E9042 \
#--indv E9043 \
#--indv E9044 \
#--indv E9045 \
#--indv E9046 \
#--indv E9047 \
#--indv E9048 \
#--indv E9049 \
#--indv E9050 \
#--indv E9051 \
#--indv E9052 \
#--indv E9053 \
#--indv E9054 \
#--indv E9055 \
#--indv E9056 \
#--indv E9057 \
#--indv E9058 \
#--indv E9059 \
#--indv E9067 \
#--indv E9569 \
#--indv E9570 \
#--out best66.auto.longchr.angsd

#AZ
#vcftools --vcf /scratch/snyder/m/mathur20/MQU/ch3/variants/angsd/best68.auto.longchr.angsd.final.recode.vcf \
#--recode --recode-INFO-all \
#--indv E9067 \
#--indv E9569 \
#--indv E9570 \
#--out etx.best68.auto.longchr.angsd.final

#Remove singletons
#cut -f1,2 stats/best68.auto.longchr.angsd.singletons | tail -n+2 > singletons.bed

#vcftools --vcf best68.auto.longchr.angsd.final.recode.vcf \
#--recode --recode-INFO-all \
#--exclude-positions singletons.bed \
#--out best68.auto.longchr.angsd.noSing
